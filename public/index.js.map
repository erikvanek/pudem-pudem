{
  "version": 3,
  "sources": ["akai-midi-mix.ts", "elektron.ts", "arturia-key-step.ts", "index.ts"],
  "sourcesContent": ["import { InputDevice, Interaction, UserEvent } from './types';\n\nexport type Fader = {\n    controlId: number;\n    min: number;\n    max: number;\n    marker: string;\n};\n\ntype FaderData = {\n    marker: string;\n    id: number;\n};\n\nconst faderData: FaderData[] = [\n    {\n        marker: '1',\n        id: 19,\n    },\n    {\n        marker: '2',\n        id: 23,\n    },\n    {\n        marker: '3',\n        id: 27,\n    },\n    {\n        marker: '4',\n        id: 31,\n    },\n    {\n        marker: '5',\n        id: 49,\n    },\n    {\n        marker: '6',\n        id: 53,\n    },\n    {\n        marker: '7',\n        id: 57,\n    },\n\n    {\n        marker: '8',\n        id: 61,\n    },\n    {\n        marker: 'master',\n        id: 62,\n    },\n];\n\ntype AkaiMidiMix = {\n    faders: Fader[];\n};\n\nconst faders: Fader[] = faderData.map((preset) => ({\n    controlId: preset.id,\n    min: 0,\n    max: 127,\n    marker: preset.marker,\n}));\n\n// todo sortout typings\n// export const AkaiMidiMix: AkaiMidiMix & InputDevice = {\n//     faders\n// }\n\nexport const startLoggingAkaiMidiMix = (device: InputDevice) => {\n    device.input.onmidimessage = onMidiNovationMessage;\n};\n\nconst onMidiNovationMessage: (e: WebMidi.MIDIMessageEvent) => void = (e) => {\n    const [userAction, controlId, value] = e.data;\n    // console.log(e.data)\n    let interaction: Interaction | null = null;\n    if (userAction === 144) {\n        interaction = 'PushDown';\n    } else if (userAction === 128) {\n        interaction = 'PushUp';\n    } else if (userAction === 176) {\n        interaction = 'Tweak';\n    }\n\n    const event: UserEvent = {\n        interaction,\n        controlId,\n        value,\n    };\n    console.log(event);\n};\n\nexport const isAkaiMidiMix = (input: WebMidi.MIDIInput) =>\n    input.name === 'MIDI Mix' && input.manufacturer === 'AKAI';\n", "import { InputDevice, Interaction, UserEvent } from './types';\n\nexport const onElektronMessage: (e: WebMidi.MIDIMessageEvent) => void = (e) => {\n    const [userAction, controlId, value] = e.data;\n    console.log([...e.data]);\n    let interaction: Interaction | null = null;\n    if (userAction === 144) {\n        interaction = 'PushDown';\n    } else if (userAction === 128) {\n        interaction = 'PushUp';\n    } else if (userAction === 176) {\n        interaction = 'Tweak';\n    }\n\n    const event: UserEvent = {\n        interaction,\n        controlId,\n        value,\n    };\n\n    console.log(event);\n};\n\nexport const startLoggingElektron = (device: InputDevice) => {\n    device.input.onmidimessage = onElektronMessage;\n};\n", "import { InputDevice, Interaction, UserEvent } from './types';\n\n// 32 keys\nconst keys = [\n    41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,\n    60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72,\n];\n\n// key is key :) and value is last timestamp it was pressed\nlet keysMap = new Map<number, number>();\n\nexport const isArturiaKeyStep = (input: WebMidi.MIDIInput) =>\n    input.name === 'Arturia KeyStep 32 MIDI 1';\n\nconst getKeyDomNode = (key: number) => document.getElementById(key.toString());\n\nexport const onArturiaMessage: (e: WebMidi.MIDIMessageEvent) => void = (e) => {\n    const [actionByte, controlId, value] = e.data;\n    const timestamp = new Date().getTime();\n    let interaction: Interaction | null = null;\n    const domNode = getKeyDomNode(controlId)!;\n    if (actionByte === 151) {\n        domNode.style.transition = 'none';\n        interaction = 'PushDown';\n        keysMap.set(controlId, timestamp);\n    } else if (actionByte === 135) {\n        interaction = 'PushUp';\n        const lastTimestamp = keysMap.get(controlId);\n        const difference = timestamp - lastTimestamp!;\n        domNode.style.transition = `background ${difference}ms`;\n        console.log(difference);\n        keysMap.delete(controlId);\n    }\n\n    const event: UserEvent = {\n        interaction,\n        controlId,\n        value,\n        timestamp,\n    };\n    redrawBox(event);\n};\n\nconst redrawBox = (event: UserEvent) => {\n    const div = getKeyDomNode(event.controlId);\n    if (div) {\n        if (event.interaction === 'PushDown') {\n            div.classList.add('active');\n        } else if (event.interaction === 'PushUp') {\n            div.classList.remove('active');\n        }\n    }\n};\n\nconst drawBoxes = () => {\n    for (const key of keys) {\n        const div = document.createElement('div');\n        div.setAttribute('id', key.toString());\n        div.setAttribute('class', 'key');\n        const textNode = document.createTextNode(key.toString());\n        div.appendChild(textNode);\n        document.getElementById('main')?.appendChild(div);\n    }\n};\n\nexport const startLoggingArturiaKeyStep = (device: InputDevice) => {\n    device.input.onmidimessage = onArturiaMessage;\n    drawBoxes();\n};\n", "import { InputDevice } from './types';\nimport { isAkaiMidiMix, startLoggingAkaiMidiMix } from './akai-midi-mix';\nimport { startLoggingElektron } from './elektron';\nimport {\n    isArturiaKeyStep,\n    startLoggingArturiaKeyStep,\n} from './arturia-key-step';\n\nconst runWebMidiApi = () =>\n    navigator.requestMIDIAccess().then((midiAccess) => {\n        console.log('web midi api running');\n        for (const entry of midiAccess.inputs) {\n            const input = entry[1];\n            const device: InputDevice = { input, controls: [] };\n            if (isAkaiMidiMix(input)) {\n                startLoggingAkaiMidiMix(device);\n            } else if (isArturiaKeyStep(input)) {\n                startLoggingArturiaKeyStep(device);\n            } else {\n                startLoggingElektron(device);\n            }\n        }\n    }, console.error);\n\nrunWebMidiApi();\n"],
  "mappings": "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",
  "names": []
}
